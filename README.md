# ChEMBL Structure Pipeline

ChEMBL protocols used to standardise and salt strip molecules. First used in ChEMBL 26.

Check the [wiki](https://github.com/chembl/ChEMBL_Structure_Pipeline/wiki) for some implementation details.

## Installation (it requires RDKit to work)

From source:

    git clone https://github.com/chembl/ChEMBL_Structure_Pipeline.git
    pip install ./ChEMBL_Structure_Pipeline

From conda:

```bash
conda install -c chembl structurepipeline
```

## Usage

### Standardise molblock


```python
from structurepipeline import standardizer

o_molblock = """
  SciTegic07111214002D
 22 19  0  0  0  0            999 V2000
   12.9184   -8.1544    0.0000 C   0  0
   13.6343   -7.7410    0.0000 N   0  0
   12.2024   -7.7410    0.0000 O   0  0
   12.9184   -8.9811    0.0000 N   0  0
   14.3503   -8.1544    0.0000 C   0  0
   15.0663   -7.7410    0.0000 C   0  0
   15.7784   -8.1460    0.0000 C   0  0
   16.4924   -7.7327    0.0000 C   0  0
   17.2064   -8.1418    0.0000 C   0  0
   17.9204   -7.7285    0.0000 C   0  0
   18.6343   -8.1376    0.0000 C   0  0
   19.3483   -7.7243    0.0000 C   0  0
   20.0623   -8.1335    0.0000 C   0  0
   20.7763   -7.7202    0.0000 C   0  0
   21.4902   -8.1293    0.0000 C   0  0
   22.2042   -7.7160    0.0000 C   0  0
   22.9207   -8.1284    0.0000 N   0  0
   23.6362   -7.7143    0.0000 C   0  0
   24.3526   -8.1267    0.0000 O   0  0
   23.6352   -6.8875    0.0000 N   0  0
   14.3464   -5.9039    0.0000 Cl  0  0
   24.1332   -6.2672    0.0000 Cl  0  0
  2  5  1  0
 11 12  1  0
  1  2  1  0
 12 13  1  0
  5  6  1  0
 13 14  1  0
 14 15  1  0
  6  7  1  0
 15 16  1  0
  1  3  1  0
 16 17  1  0
  7  8  1  0
 17 18  1  0
 18 19  1  0
  8  9  1  0
 18 20  2  0
  1  4  2  0
  9 10  1  0
 10 11  1  0
M  END"""

std_molblock = standardizer.standardize_molblock(o_molblock)
```

### Get the parent molecule


```python
from structurepipeline import standardizer


o_molblock = """
  Mrv0541 09091311452D          

 39 41  0  0  0  0            999 V2000
    1.7130   -5.6719    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8417   -3.5578    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.5031   -2.1484    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    2.2000   -6.3308    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.8880   -5.6776    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.0167   -3.5578    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
   -4.0906   -2.8531    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
    1.9536   -7.1156    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5984   -4.2625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.2656   -2.8531    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.7734   -4.2625    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.2484   -4.2797    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -4.0906   -1.4266    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    0.4641   -4.9558    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.0109   -4.9844    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.4812   -6.3937    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    1.1458   -7.2933    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3609   -4.9558    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.3167   -2.1484    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3667   -3.5406    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
    2.1942   -5.0016    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    2.5094   -7.7344    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5870   -5.6948    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8703    0.7219    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0
    2.9848   -6.0730    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    2.9734   -5.2480    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -6.1417   -1.3234    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8531   -2.1312    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -6.1417   -2.1484    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -5.3167   -1.3234    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.2828    0.0114    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.9995   -6.4109    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.7734   -5.6891    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -3.2656   -1.4151    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8589   -0.7047    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.3495   -6.3937    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -1.5812   -7.1214    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.7562   -7.1156    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.6895   -4.8297    0.0000 H   0  0  0  0  0  0  0  0  0  0  0  0
  2  6  1  0  0  0  0
  3  7  1  0  0  0  0
  4  1  1  0  0  0  0
  5  1  1  0  0  0  0
  6  9  1  0  0  0  0
  7 10  1  0  0  0  0
  8  4  1  0  0  0  0
  9 11  1  0  0  0  0
 10  2  1  0  0  0  0
 11 18  1  0  0  0  0
 12  2  2  0  0  0  0
 13  3  2  0  0  0  0
 14  5  1  0  0  0  0
 15  9  1  0  0  0  0
 16  5  2  0  0  0  0
 17  8  2  0  0  0  0
 18 14  1  0  0  0  0
 19  3  1  0  0  0  0
 20 11  2  0  0  0  0
 21  1  1  0  0  0  0
 22  8  1  0  0  0  0
 23 15  1  0  0  0  0
 24 31  1  0  0  0  0
 25  4  1  0  0  0  0
 26 21  1  0  0  0  0
 27 30  1  0  0  0  0
 28 10  1  0  0  0  0
 29 19  1  0  0  0  0
 30 19  1  0  0  0  0
 31 35  1  0  0  0  0
 32 23  2  0  0  0  0
 33 23  1  0  0  0  0
 34 28  1  0  0  0  0
 35 34  1  0  0  0  0
 36 33  2  0  0  0  0
 37 32  1  0  0  0  0
 38 36  1  0  0  0  0
 39 26  1  0  0  0  0
 25 26  1  0  0  0  0
 37 38  2  0  0  0  0
 27 29  1  0  0  0  0
M  ISO  1  39   3
M  END"""

parent_molblock, _ = standardizer.get_parent_molblock(o_molblock)
```
